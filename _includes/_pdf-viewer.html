<!-- pdf canvas -->
<div id="canvas-wrapper" style="position: relative;">
    <canvas id="pdf-canvas" class="w-full rounded-xl"></canvas>
    <div id="loading-overlay" style="
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: black;
      opacity: 1;
      pointer-events: none;
      transition: opacity 0.2s;
      z-index: 10;
      display: none;
  "></div>
</div>

<!-- nav script -->
<script type="module">
	import * as pdfjsLib from '/assets/js/pdf.mjs';
	pdfjsLib.GlobalWorkerOptions.workerSrc = '/assets/js/pdf.worker.mjs';
	pdfjsLib.GlobalWorkerOptions.workerType = 'module';

	const url = '/assets/pdf/joeyMariano-notebook2023-25.pdf';
	let pdfDoc = null;
	let pageNumber = 14;

	const canvas = document.getElementById('pdf-canvas');
	const context = canvas.getContext('2d');

    function showLoading() {
        document.getElementById('loading-overlay').style.display = 'block';
    }
    function hideLoading() {
        document.getElementById('loading-overlay').style.display = 'none';
    }

    // Update renderPage to use loading overlay
    async function renderPage(num) {
        showLoading();
        const page = await pdfDoc.getPage(num);
        const scale = 1.5;
        const viewport = page.getViewport({ scale });
        canvas.height = viewport.height;
        canvas.width = viewport.width;

        await page.render({ canvasContext: context, viewport }).promise;
        hideLoading();
    }

	// Load PDF
	pdfjsLib.getDocument(url).promise.then(pdf => {
		pdfDoc = pdf;
		renderPage(pageNumber);
	});

	document.getElementById("prev-page").addEventListener("click", () => {
		if (pageNumber <= 1) return; // avoid going before first page
		pageNumber--;
		console.log("pageNumber:", pageNumber);
		renderPage(pageNumber);
	});

	document.getElementById("next-page").addEventListener("click", () => {
		if (!pdfDoc) return;
		if (pageNumber >= pdfDoc.numPages) return; // avoid going past last page
		pageNumber++;
		console.log("pageNumber:", pageNumber);
		renderPage(pageNumber);
	});
</script>